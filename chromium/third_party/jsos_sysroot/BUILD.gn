# JSOS sysroot — third_party/jsos_sysroot/BUILD.gn  (Phase 9)
#
# Defines the public include path and pre-built static library archives
# that Chromium modules compiled for JSOS link against.
#
# Static archives are produced by the JSOS kernel build (src/kernel/Makefile)
# and placed in third_party/jsos_sysroot/lib/ before running GN.

import("//build/config/jsos/platform.gni")

# ── Public include path ────────────────────────────────────────────────────

config("jsos_sysroot_include") {
  include_dirs = [ "include" ]
}

# ── Pre-built static libraries ─────────────────────────────────────────────

static_library("jsos_posix") {
  # libposix.a is the compiled Phase 6 POSIX layer (syscalls + libc shim).
  # Built by src/kernel/Makefile target 'posix'.
  libs = [ "posix" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

static_library("jsos_net") {
  # libnet.a: Phase 7 TCP/IP + TLS sockets compiled to ELF32.
  libs = [ "net" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

static_library("jsos_mbedtls") {
  # libmbedtls.a: mbedTLS cross-compiled for i686-elf.
  libs = [ "mbedtls" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

static_library("jsos_swiftshader") {
  # libswiftshader.a: Phase 8 SwiftShader Vulkan/GL backend for i686-elf.
  libs = [ "swiftshader" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

static_library("jsos_gbm") {
  # libgbm_jsos.a: minigbm shim for JSOS DRM/KMS (Phase 8).
  libs = [ "gbm_jsos" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

static_library("jsos_libc") {
  # libjsos_libc.a: minimal libc stub (minimal_libc.c + allocator).
  libs = [ "jsos_libc" ]
  lib_dirs = [ "lib" ]
  public_configs = [ ":jsos_sysroot_include" ]
}

# ── Convenience group: everything Chromium needs at link time ──────────────

group("all") {
  public_deps = [
    ":jsos_posix",
    ":jsos_net",
    ":jsos_mbedtls",
    ":jsos_swiftshader",
    ":jsos_gbm",
    ":jsos_libc",
  ]
}
